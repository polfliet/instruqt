slug: activate-infrastructure
id: hfsnumyy82wg
type: track
title: Product Activate - New Relic Infrastructure
teaser: Learn how to use New Relic Infrastructure
description: This lab is intended to give you experience of deploying the New Relic
  Infrastructure solution and to extend the information that the New Relic Infrastructure
  agent collects.
icon: https://github.com/polfliet/instruqt/raw/master/assets/icons/nr-infrastructure.png
tags:
- infrastructure
owner: newrelic
developers:
- svandamme@newrelic.com
- mechandi@newrelic.com
- asavory@newrelic.com
- spolfliet@newrelic.com
private: true
published: true
challenges:
- slug: install-new-relic-infrastructure
  id: a1v3kmp7echz
  type: challenge
  title: Install New Relic Infrastructure
  teaser: Install the New Relic Infrastructure agent
  assignment: "# Check your operating system\nThe first step to installing the New
    Relic infrastructure agent is figuring out which agent to install. New Relic supports
    several package management systems (`apt`, `yum`, `zypper`) and operating systems,
    which means the install instructions are different for each.\n\nThe simplest way
    to figure out which package manager you have is to discover which operating system
    is installed. Running the following command will give you that information.\n\n```\ncat
    /etc/os-release\n```\n\nCheck out the `NAME` and `PRETTY_NAME` variable for the
    name of the operating system. `VERSION_ID` gives you a hint on the version.\n\n#
    Install New Relic Infrastructure\nOpen a tab in your browser and go to [New Relic
    One](one.newrelic.com).\nIn the top-right, click on your name and click on `Instrument
    your system`\n\n![Instrument your system](https://github.com/polfliet/instruqt/blob/master/activate-infrastructure/assets/gifs/instrument-system.gif?raw=true
    \"Instrument your system\")\n\nAfter selecting the right operating system follow
    the instructions within New Relic:\n* Select your New Relic account\n* Choose
    the correct operating system\n* Copy the installation instructions to the terminal
    window\n\nYou can check if your installation was succesfull by running: \n\n```\nservice
    newrelic-infra status\n```\n\nIf it says `Active: active (running)` you are all
    good. Press `q` to exit this command.\n"
  notes:
  - type: text
    contents: Please wait while we are starting your Linux server
  tabs:
  - title: Terminal
    type: terminal
    hostname: ubuntu
  difficulty: basic
  timelimit: 900
- slug: agent-lifecycle
  id: ldc0mrjxt1pc
  type: challenge
  title: Agent Lifecycle
  teaser: Learn how to stop, start, restart the agent
  assignment: |
    You can start, stop, or restart the agent using:
    ```
    sudo systemctl <start|stop|restart|status> newrelic-infra
    ```

    ### Stop the agent if itâ€™s running:
    ```
    sudo systemctl stop newrelic-infra
    ```

    ### Start the agent:
    ```
    sudo systemctl start newrelic-infra
    ```

    ### Check the status of the agent:
    ```
    sudo systemctl status newrelic-infra
    ```
    Use `q` to quit

    ### Restart the agent:
    ```
    sudo systemctl restart newrelic-infra
    ```

    ### Check the status of the agent again:
    ```
    sudo systemctl status newrelic-infra
    ```
    Use `q` to quit
  notes:
  - type: text
    contents: Time to learn more about the lifecycle of the New Relic Infrastructure
      agent
  tabs:
  - title: Terminal
    type: terminal
    hostname: ubuntu
  difficulty: basic
  timelimit: 900
- slug: nri-customizing
  id: q8q90xgjgkay
  type: challenge
  title: Agent configuration
  teaser: Customizing the agent
  assignment: |-
    Now that we have a running agent, let's take a look at the configuration. We're going to add a couple of labels (so we can more easily find a group of servers), as well as change the hostname.

    # Configuration files
    When the New Relic agent is installed it will create a `/etc/newrelic-infra` directory. Let's take a look at what's inside that directory.

    ```
    ls /etc/newrelic-infra
    ```

    Note that we have 2 directories:
    * `integrations.d/`: Configuration files for New Relic Infrastructure OHI's (On-Host integrations) can be found here
    * `logging.d/`: Configuration files for setting up New Relic Logs

    The New Relic agent also has a configuration file `newrelic-infra.yml` which you can find in `/etc`.

    ```
    cat /etc/newrelic-infra.yml
    ```

    # Customizing the agent
    Let's add some labels and change the hostname of our agent. To do that, use the Instruqt editor to open `/etc/newrelic-infra.yml`.

    We're going to add some labels to make it easier to group our hosts for alerting and dashboarding. In this case we're adding the location of the server, the group that's managing it, and the environment. Copy paste this information into the `/etc/newrelic-infra.yml` file. You can always add your own labels to test.

    ```
    custom_attributes:
        environment: staging
        location: eu-brussels-1
        team: ops-falcon
    ```

    Next thing is to change our display name, this can be handy in environments where a lot of hosts share the same name. Changing the display name to something unique will make it easier to find the host in New Relic UI. Again copy paste this information in the `/etc/newrelic-infra.yml` file.

    ```
    display_name: app1-staging-eu
    ```

    You can now save the `newrelic-infra.yml` file and restart the agent. Restarting the agent can be done by running the following command. In this case we're using the service command, keep in mind that this might be different depending on the Operating System.

    ```
    service newrelic-infra restart
    ```

    After restarting the agent you will see a new host appear in the New Relic UI, with the `display_name` you've given it.

    Congratulations, you've now installed and configured a New Relic Infrastructure agent.
  notes:
  - type: text
    contents: We will now learn how to customize the agent
  tabs:
  - title: Terminal
    type: terminal
    hostname: ubuntu
  - title: Editor
    type: code
    hostname: ubuntu
    path: /etc/newrelic-infra.yml
  difficulty: basic
  timelimit: 900
- slug: nri-explore
  id: ecavkukkjosq
  type: challenge
  title: Exploring the data
  teaser: Explore the data
  assignment: |+
    Now that the Infrastructure agent is pushing data to the New Relic platform, let's take a look at the data coming in.

    Navigate to the New Relic Infrastructure UI

    Make sure to check out the following pages:

    * Hosts
    * Network
    * Storage
    * Processes
    * Inventory
    * Events

    Can you answer the following questions:
    * Hosts: What instanceType is this machine?
    * Processes: What process was consuming a lot of resources?
    * Inventory: Is root login via ssh permitted?
    * Events: When was the time-consuming process installed?

  tabs:
  - title: New Relic One
    type: website
    hostname: ubuntu
    url: https://one.newrelic.com
  difficulty: basic
  timelimit: 500
checksum: "14528391577385230718"
